<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Submit A Review</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body style="padding: 5%">
        <div id="itemReviews"></div>
        <form id="reviewForm" method="post" onsubmit="postReview()">
            <div>
                <label for="rating">Rating:</label>
                <div style="display: flex; flex-direction: column">
                    <label for="rating1">
                        <input type="radio" id="rating1" name="rating" value="1" required />
                        1
                    </label>
                    <br />
                    <label for="rating2">
                        <input type="radio" id="rating2" name="rating" value="2" required />
                        2
                    </label>
                    <br />
                    <label for="rating3">
                        <input type="radio" id="rating3" name="rating" value="3" required />
                        3
                    </label>
                    <br />
                    <label for="rating4">
                        <input type="radio" id="rating4" name="rating" value="4" required />
                        4
                    </label>
                    <br />
                    <label for="rating5">
                        <input type="radio" id="rating5" name="rating" value="5" required />
                        5
                    </label>
                    <br />
                </div>
            </div>

            <br />

            <div style="display: flex; flex-direction: column">
                <label for="reviewText">Review:</label>
                <textarea id="reviewText" name="reviewText"></textarea>
            </div>

            <br />

            <button type="submit">Submit Review</button>
        </form>

        <script>
            function validateForm() {
                // check if all required inputs are filled
                const inputs = document.querySelectorAll("input[required], textarea[required]");
                for (let i = 0; i < inputs.length; i++) {
                    if (!inputs[i].value) {
                        alert("Please fill in rating field.");
                        return false; // Prevent form submission
                    }
                }
                return true;
            }
            
            function postReview() {
            	if (validateForm()) {
					$.ajax({
						url: "post_review.php",
						type: "POST",
						success: function (data) {
							// display data to user
							displayReviews(data);
						},
						error: function (xhr, status, error) {
							console.error("Error fetching reviews:", error);
							reviewsContainer.innerHTML = `
								<p style="background-color: #f8d7da; color: #721c24; padding: 10px; border: 1px solid #f5c6cb;">
									Error: Something went wrong fetching your reviews.
								</p>
							`;
						},
					});
				}
			}
			
			function displayReviews(data) {
            	$("body").append("<p>"+ data.message +"</p>");
			}
        </script>
    </body>
</html>
